expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black")+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.5)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.1)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
str(kormap2)
kormap2$region=kormap2$sigungu_cd
str(kormap2)
str(kormap3)
kormap3$region=kormap3$adm_dr_cd
str(kormap3)
ggplot(data2,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
kormap1
str(kormap1)
saveRDS(kormap1,"kormap1.RDS")
saveRDS(kormap2,"kormap2.RDS")
saveRDS(kormap3,"kormap3.RDS")
saveRDS(kormap3,"kormap3.RDS")
str(kormap3)
popdata=read.csv("pop2016.csv",header=T,skip=2,fileEncoding="euc-kr")
str(popdata)
summary(popdata)
unique(popdata$X5세별)
newdata=popdata[popdata$X5세별=="계",]
str(newdata))
str(newdata)
unique(newdata$시점)
newdata=newdata[newdata$시점==201609,]
str(newdata)
newdata=newdata[c(1,2,6:8)]
str(newdata)
colnames(newdata)=c("C행정구역별","행정구역별","총인구","남자","여자")
str(newdata)
data1=census2data(newdata,1)
nrow(data1)
data2=census2data(newdata,2)
nrow(data2)
data3=census2data(newdata,3)
nrow(data3)
tail(newdata)
kormap3
summary(kormap3)
str(newdata)
census2data=function(census.data,mode=1){
data=NULL
if(is.numeric(mode) & (mode>0) & (mode<4)) {
names(census.data)<-gsub("[[:punct:]]+","_",gsub("[[:punct:]]$","",names(census.data)))
census.data$C행정구역별<-sub("^\\'","",census.data$C행정구역별)
if(mode==1) data<-subset(census.data,nchar(C행정구역별)==2 & C행정구역별>10)
else if(mode==2) {
data<-subset(census.data,nchar(C행정구역별)==5)
data<-subset(data,행정구역별 %!in% c(" 동부", " 읍부", " 면부"))
}
else if(mode==3) data<-subset(census.data,nchar(C행정구역별)>=7)
}
data$code=data$C행정구역별
data
}
data3=census2data(newdata,3)
nrow(data3)
str(data3)
data3$code=substr(data3$code,1,7)
str(data3)
ggplot(data1,aes(map_id=code,fill=총인구))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data2,aes(map_id=code,fill=총인구))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data2,aes(map_id=code,fill=총인구))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data3,aes(map_id=code,fill=총인구))+geom_map(map=kormap3,colour="black",size=0.2)+
expand_limits(x=kormap3$long,y=kormap3$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
str(newdata)
data1
areacode
str(newdata)
str(newdata)
data1
popdata=read.csv("pop2016.csv",header=T,skip=2,fileEncoding="euc-kr")
str(popdata)
popdata=popdata[popdata$X5세별=="계",]
data1
data1
areacode
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
data1=census2data(census.data,mode=1)
nrow(data1)
str(data1)
data2=census2data(census.data,mode=2)
nrow(data2)
str(data2)
ggplot(data1,aes(map_id=code,fill=총인구))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data2,aes(map_id=code,fill=총인구))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data2,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data3,aes(map_id=code,fill=총인구))+geom_map(map=kormap3,colour="black",size=0.2)+
expand_limits(x=kormap3$long,y=kormap3$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
library(ggplot2)
=
=
=
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
ggplot(data2,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap2,colour="black",size=0.2)+
expand_limits(x=kormap2$long,y=kormap2$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
library(moonBook2)
data1
ggChoropleth(data1,kormap1)
ggChoropleth(data1,kormap1,interactive=TRUE)
ggChoropleth(data1,kormap1,tooltip="행정구역별",interactive=TRUE)
ggplot(kormap1,aes(x=long,y=lat,group=group,fill=name))+geom_polygon()+coord_map()+
theme(legend.text=element_text(family="NanumGothic"))
ggChoropleth(data2,kormap2,tooltip="행정구역별",interactive=TRUE)
saveRDS(data1,"korpop2014_1.RDS")
saveRDS(data2,"korpop2014_2.RDS")
data1
ggChoropleth(data1,kormap1,tooltip="행정구역별",interactive=TRUE)
ggChoropleth(data2,kormap2,tooltip="행정구역별",interactive=TRUE)
ggChoropleth(data2,kormap2,tooltip="행정구역별",subarea="전라,광주",interactive=TRUE)
ggChoropleth(data2,kormap2,tooltip="행정구역별",subarea="전라,광주",interactive=TRUE)
ggChoropleth(data2,kormap2,tooltip="행정구역별",interactive=TRUE)
ggChoropleth(data1,kormap1,tooltip="행정구역별",interactive=TRUE)
library(maptools)
library(ggplot2)
ggplot(data1,aes(map_id=code,fill=총인구_명))+geom_map(map=kormap1,colour="black",size=0.2)+
expand_limits(x=kormap1$long,y=kormap1$lat)+coord_map()+
scale_fill_gradientn(colours=c("white","orange","red"))+
theme(legend.title=element_text(family="NanumGothic"))
require(tmap)
install.packages("tmap")
qtm(kormap1)
require(tmap)
qtm(kormap1)
require(rgdal)
crsTMcenter<-CRS("+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=500000 +ellps=bessel +units=m +no_defs")
crsWGS84lonlat<-CRS("+proj=longlat +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs +lat_0=38N +lon_0=127E")
kormap11=spTransform(kormap1,crsTMcenter)
kormap11=shape2map("data/level1.shp",mode=2)
source('~/ownCloud/Documents/kormaps2014/Shape.R', echo=TRUE)
kormap11=shape2map("data/level1.shp",mode=2)
qtm(kormap11)
kormap11=shape2map("shape/level1.shp",mode=2)
qtm(kormap11)
kormap11=shape2map("행정구역지도2014/level1.shp",mode=2)
qtm(kormap11)
kormap11=shape2map("행정구역지도2014/level1.shp",mode=1)
qtm(kormap11)
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
colnames(census.data)
nrow(census.data)
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
nrow(census.data)
data3=census2data(census.data,mode=3)
nrow(data3)
str(data3)
ggChoropleth(data3,kormap3,tooltip="행정구역별",interactive=TRUE)
library(ggplot2)
library(moonBook2)
ggChoropleth(data1,kormap1,tooltip="행정구역별",interactive=TRUE)
ggChoropleth(data2,kormap2,tooltip="행정구역별",interactive=TRUE)
ggChoropleth(data3,kormap3,tooltip="행정구역별",interactive=TRUE)
saveRDS(data2,"korpop2014_3.RDS")
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
data1=census2data(census.data,mode=1)
nrow(data1)
str(data1)
data2=census2data(census.data,mode=2)
nrow(data2)
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
data1=census2data(census.data,mode=1)
nrow(data1)
str(data1)
data2=census2data(census.data,mode=2)
nrow(data2)
str(data2)
data3=census2data(census.data,mode=3)
nrow(data3)
str(data3)
census2data=function(census.data,mode=1){
data=NULL
if(is.numeric(mode) & (mode>0) & (mode<4)) {
names(census.data)<-gsub("[[:punct:]]+","_",gsub("[[:punct:]]$","",names(census.data)))
census.data$C행정구역별<-sub("^\\'","",census.data$C행정구역별)
if(mode==1) data<-subset(census.data,nchar(C행정구역별)==2 & C행정구역별>10)
else if(mode==2) {
data<-subset(census.data,nchar(C행정구역별)==5)
data<-subset(data,C행정구역별 %!in% c(" 동부", " 읍부", " 면부"))
}
else if(mode==3) data<-subset(census.data,nchar(C행정구역별)>=7)
}
data$code=data$C행정구역별
data
}
data2=census2data(census.data,mode=2)
nrow(data2)
str(data2)
data3=census2data(census.data,mode=3)
nrow(data3)
str(data3)
saveRDS(data1,"korpop2015_1.RDS")
saveRDS(data2,"korpop2015_2.RDS")
saveRDS(data2,"korpop2015_3.RDS")
census.data=read.csv("101_DT_1IN1502_Y_2015.csv",header=T,skip=2,fileEncoding="euc-kr")
data3=census2data(census.data,mode=3)
nrow(data3)
saveRDS(data3,"korpop2015_3.RDS")
library(kormaps2014)
library(kormaps2014)
library(kormaps2014)
kormap1
head(korpop2015_1)
devtools::document()
library(kormaps2014)
library(kormaps2014)
devtools::document()
library(kormaps2014)
load("~/ownCloud/Documents/kormaps2014/data/areacode.rda")
areacode
escape_unicode_data=function(data,change.colnames=TRUE,cols=c(2)){
if(change.colnames){
colnames(data)=stringi::stri_escape_unicode(colnames(data))
}
for(i in 1:length(cols)){
data[[cols[i]]]=stringi::stri_escape_unicode(data[[cols[i]]])
}
data
}
areacode1=escape_unicode_data(areacode,FALSE,cols=2:3)
areacode1
require(ggplot2)
require(moonBook2)
ggChoropleth(areacode,kormap1)
ggChoropleth(areacode,kormap1,"name")
ggChoropleth(areacode,kormap1,"name",interactive=TRUE)
ggChoropleth(areacode,kormap1,"name",interactive=TRUE,tooltip="name")
ggChoropleth(areacode,kormap1,"name",interactive=TRUE)
str(kormap1)
ggChoropleth
map<-kormap1
p<-ggplot(data=areacode,aes(map_id=code,fill=name))+
expand_limits(x=map$long,y=map$lat)+coord_map()+
geom_map(map=map,colour='black',size=0.1)
p
ggChoropleth(areacode1,kormap1,"name",interactive=TRUE)
escape_unicode_data=function(data,change.colnames=TRUE,cols=NULL){
if(change.colnames){
colnames(data)=stringi::stri_escape_unicode(colnames(data))
}
if(is.null(cols)) cols=1:ncol(data)
for(i in 1:length(cols)){
data[[cols[i]]]=stringi::stri_escape_unicode(data[[cols[i]]])
}
data
}
areacode
areacode1=escape_unicode_data(areacode)
areacode1
unescape_unicode_data=function(data,change.colnames=TRUE,cols=NULL){
if(change.colnames){
colnames(data)=stringi::stri_unescape_unicode(colnames(data))
}
if(is.null(cols)) cols=1:ncol(data)
for(i in 1:length(cols)){
data[[cols[i]]]=stringi::stri_unescape_unicode(data[[cols[i]]])
}
data
}
areacode
areacode1=escape_unicode_data(areacode)
areacode1
areacode2=unescape_unicode_data(areacode1)
areacode2
ggChoropleth(areacode2,kormap1,"name",interactive=TRUE)
ggChoropleth(areacode2,kormap1,"name")
theme_set(theme_gray(base_family="NanumGothic"))
ggChoropleth(areacode2,kormap1,"name")
ggChoropleth(areacode2,kormap1,"name",interactive=TRUE)
areacode2
areacode
areacode1=escape_unicode_data(areacode)
areacode1
ggChoropleth(areacode1,kormap1,"name")
ggChoropleth(areacode1,kormap1,"name",interactive=TRUE)
ggChoropleth(areacode1,kormap1,"name")
ggChoropleth(areacode1,kormap1,"name",interactive=TRUE)
ggChoropleth(areacode2,kormap1,"name")
ggChoropleth(areacode2,kormap1,"name",interactive=TRUE)
korpop2015_3new=escape_unicode_data(korpop2015_3)
str(korpop2015_3new)
kormap3new=escape_unicode_data(kormap3)
str(kormap3)
kormap3=kormap3[-c(11,13)]
str(kormap3)
kormap3new=escape_unicode_data(kormap3)
str(kormap3new)
kormap3new2=unescape_unicode_data(kormap3new)
str(kormap3new2)
str(kormap3new)
areacode1
kormap3=escape_unicode_data(kormap3)
str(kormap2)
kormap2=kormap2[-c(11,13)]
kormap2
str(kormap2)
kormap2=escape_unicode_data(kormap2)
str(kormap1)
kormap1=kormap1[-c(10,13)]
kormap1
str(kormap1)
kormap1=escape_unicode_data(kormap1)
korpop2015_3=escape_unicode_data(korpop2015_3)
korpop2015_2=escape_unicode_data(korpop2015_2)
korpop2015_1=escape_unicode_data(korpop2015_1)
areacode
areacode=escape_unicode_data(areacode)
areacode
str(kormap1)
str(korpop2015_1)
str(korpop2015_2)
str(korpop2015_3)
devtools::use_data(areacode,overwrite=TRUE)
devtools::use_data(kormap1,overwrite=TRUE)
devtools::use_data(kormap2,overwrite=TRUE)
devtools::use_data(kormap3,overwrite=TRUE)
devtools::use_data(korpop2015_1,overwrite=TRUE)
devtools::use_data(korpop2015_2,overwrite=TRUE)
devtools::use_data(korpop2015_3,overwrite=TRUE)
areacode
str(kormap1)
str(kormap2)
str(kormap3)
str(korpop2015_1)
str(korpop2015_2)
str(korpop2015_3)
unescape_all=function(){
areacode=unescape_unicode_data(areacode)
kormap1=unescape_unicode_data(kormap1)
kormap2=unescape_unicode_data(kormap2)
kormap3=unescape_unicode_data(kormap3)
korpop2015_1=unescape_unicode_data(korpop2015_1)
korpop2015_2=unescape_unicode_data(korpop2015_2)
korpop2015_3=unescape_unicode_data(korpop2015_3)
}
library(kormaps2014)
areacode
source('~/ownCloud/Documents/kormaps2014/R/areacode.R', echo=TRUE)
library(kormaps2014)
library(kormaps2014)
areacode
str(areacode)
areacode
library(kormaps2014)
library(kormaps2014)
areacode
library(kormaps2014)
unescape_all()
str(areacode)
str(areacode)
source('~/ownCloud/Documents/kormaps2014/R/areacode.R', echo=TRUE)
library(kormaps2014)
library(kormaps2014)
library(kormaps2014)
areacode
str(areacode)
library(kormaps2014)
library(kormaps2014)
areacode
areacode=unescape_unicode_data(areacode)
library(kormaps2014)
library(kormaps2014)
areacode
library(kormaps2014)
areacode
library(kormaps2014)
areacode
str(kormap1)
str(kormap2)
str(kormap3)
View(kormap)
library(kormaps2014)
str(kormap3)
str(kormap1)
str(kormap2)
str(areacode)
library(kormaps2014)
str(korpop2105_1)
str(korpop2015_1)
library(kormaps2014)
str(korpop2015_2)
library(kormaps2014)
str(korpop2015_3)
areacode
str(kormap1)
str(kormap2)
str(kormap3)
library(kormaps2014)
devtools::document()
source('~/ownCloud/Documents/kormaps2014/R/areacode.R', echo=TRUE)
library(kormaps2014)
library(kormaps2014)
areacode
str(kormap1)
library(kormaps2014)
require(moonBook2)
ggChoropleth(areacode,kormap1,"code")
require(ggplot2)
ggChoropleth(areacode,kormap1,"code")
ggChoropleth(areacode,kormap1,fillvar="code")
areacode
kormap1
ggChoropleth(areacode,kormap1,fillvar="code")
ggChoropleth(korpop2015_1,kormap1)
unescape_all=function(){
areacode<<-unescape_unicode_data(areacode)
kormap1<<-unescape_unicode_data(kormap1)
kormap2<<-unescape_unicode_data(kormap2)
kormap3<<-unescape_unicode_data(kormap3)
korpop2015_1<<-unescape_unicode_data(korpop2015_1)
korpop2015_2<<-unescape_unicode_data(korpop2015_2)
korpop2015_3<<-unescape_unicode_data(korpop2015_3)
}
unescape_all()
unescape_unicode_data=function(data,change.colnames=TRUE,cols=NULL){
if(change.colnames){
colnames(data)=stringi::stri_unescape_unicode(colnames(data))
}
if(is.null(cols)) cols=1:ncol(data)
for(i in 1:length(cols)){
data[[cols[i]]]=stringi::stri_unescape_unicode(data[[cols[i]]])
}
data
}
unescape_all()
library(kormaps2014)
ggChoropleth(korpop2015_1,kormap1)
areacode
devtools::use_data(areacode,overwrite=TRUE)
devtools::use_data(kormap1,overwrite=TRUE)
devtools::use_data(kormap2,overwrite=TRUE)
devtools::use_data(kormap3,overwrite=TRUE)
devtools::use_data(korpop2015_1,overwrite=TRUE)
devtools::use_data(korpop2015_2,overwrite=TRUE)
devtools::use_data(korpop2015_3,overwrite=TRUE)
library(kormaps2014)
areacode
str(kormap1)
library(kormaps2014)
library(kormaps2014)
areacode
ggChoropleth(areacode,kormaps1,fillvar="code")
ggChoropleth(areacode,kormap1,fillvar="code")
install_github("cardiomoon/moonBook2")
devtools::install_github("cardiomoon/moonBook2")
ggChoropleth(areacode,kormap1,fillvar="code")
crimes <- data.frame(state = tolower(rownames(USArrests)), USArrests)
require(ggplot2)
states_map <- map_data("state")
ggChoropleth(crimes,states_map,fill="Murder",map_id="state",tooltip="state",interactive=TRUE)
crimes <- data.frame(state = tolower(rownames(USArrests)), USArrests)
require(ggplot2)
states_map <- map_data("state")
ggChoropleth(crimes,states_map,fill="Murder",map_id="state",tooltip="state")
